<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="基础算法,">










<meta name="description" content="BFS是最简单的图搜索算法之一，也是很多复杂算法的基础。最简单的模型是：给你一个图和一个起点，你从该点出发，搜索与之相邻的点，然后再搜索邻接点的邻接点，直到找到目标 图有很多变种，无向图和有向图对于BFS其实都差不多，读取对应的邻接信息就好了，如果是带权图，BFS要启用优先队列来代替普通的队列 BFS需要队列来存储找到的节点，队列先进先出的原则保证了先找到的点先展开 除此之外，开始的点也不一定是一">
<meta name="keywords" content="基础算法">
<meta property="og:type" content="article">
<meta property="og:title" content="算法题整理——BFS搜索">
<meta property="og:url" content="http://yoursite.com/2023/01/15/算法题整理——BFS搜索/index.html">
<meta property="og:site_name" content="Jameci&#39;s Blog">
<meta property="og:description" content="BFS是最简单的图搜索算法之一，也是很多复杂算法的基础。最简单的模型是：给你一个图和一个起点，你从该点出发，搜索与之相邻的点，然后再搜索邻接点的邻接点，直到找到目标 图有很多变种，无向图和有向图对于BFS其实都差不多，读取对应的邻接信息就好了，如果是带权图，BFS要启用优先队列来代替普通的队列 BFS需要队列来存储找到的节点，队列先进先出的原则保证了先找到的点先展开 除此之外，开始的点也不一定是一">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="http://yoursite.com/images/算法题整理——BFS搜索/0.png">
<meta property="og:updated_time" content="2023-01-15T09:42:42.660Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="算法题整理——BFS搜索">
<meta name="twitter:description" content="BFS是最简单的图搜索算法之一，也是很多复杂算法的基础。最简单的模型是：给你一个图和一个起点，你从该点出发，搜索与之相邻的点，然后再搜索邻接点的邻接点，直到找到目标 图有很多变种，无向图和有向图对于BFS其实都差不多，读取对应的邻接信息就好了，如果是带权图，BFS要启用优先队列来代替普通的队列 BFS需要队列来存储找到的节点，队列先进先出的原则保证了先找到的点先展开 除此之外，开始的点也不一定是一">
<meta name="twitter:image" content="http://yoursite.com/images/算法题整理——BFS搜索/0.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2023/01/15/算法题整理——BFS搜索/">





  <title>算法题整理——BFS搜索 | Jameci's Blog</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Jameci's Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">天下雷行，物与无妄。先王以茂对时，育万物。</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2023/01/15/算法题整理——BFS搜索/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jameci">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Jameci's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">算法题整理——BFS搜索</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2023-01-15T15:42:40+08:00">
                2023-01-15
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/基础算法/" itemprop="url" rel="index">
                    <span itemprop="name">基础算法</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          
            <span class="post-meta-divider">|</span>
            <span class="page-pv"><i class="fa fa-file-o"></i>
            <span class="busuanzi-value" id="busuanzi_value_page_pv"></span>
            </span>
          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>BFS是最简单的图搜索算法之一，也是很多复杂算法的基础。最简单的模型是：给你一个图和一个起点，你从该点出发，搜索与之相邻的点，然后再搜索邻接点的邻接点，直到找到目标</p>
<p>图有很多变种，无向图和有向图对于BFS其实都差不多，读取对应的邻接信息就好了，如果是带权图，BFS要启用优先队列来代替普通的队列</p>
<p>BFS需要队列来存储找到的节点，队列先进先出的原则保证了先找到的点先展开</p>
<p>除此之外，开始的点也不一定是一个，可能多个点同时开始，也可能是起点和终点的双向BFS（比如迷宫中两人相遇问题）</p>
<p>但实际上，能用BFS解决的问题不仅仅是图搜索，图和节点往往是隐藏的，抽象的——实际问题可能看上去和图上查找对应节点毫不相关，但将其内在的逻辑关系理清后，发现完全可以用BFS来做</p>
<p>BFS还经常用于洪泛问题——从一个点出发，按临界距离的远近一步一步为周遭的节点打上标签。这样的洪泛不仅仅在图上进行，还可以是坐标组成的网格——它们具有天然的邻居关系</p>
<p>BFS算法应用时，复杂度一般就是考虑节点数量和每个节点连接的边数，或是抽象节点的数量</p>
<p>在例题中，除了抽象图之外，还可能会出现更复杂的情况——如推箱子问题，箱子每走一步都意味着人的一次BFS，实际上就是一个双层的BFS</p>
<p>由于BFS也常常作为其他算法的基础，我们也会看到BFS仅仅用于查询当前可到达节点，真正的算法决策需要其他条件来配合的情况</p>
<h1 id="POJ3278-Catch-The-Cow"><a href="#POJ3278-Catch-The-Cow" class="headerlink" title="POJ3278_Catch The Cow"></a>POJ3278_Catch The Cow</h1><h2 id="描述"><a href="#描述" class="headerlink" title="描述"></a>描述</h2><p>Farmer John的一头牛逃跑了，现在FJ在位置N，牛在位置K，FJ可以花费一分钟做以下三种操作：（假设现在FJ的位置是cur）</p>
<p>1 移动到cur + 1。</p>
<p>2 移动到cur - 1。</p>
<p>3 传送到cur × 2。</p>
<p>求FJ到达K点的最短时间。</p>
<h2 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h2><p>经典中的经典，BFS，当前大一刚刚入队就做过这道题。之所以再做是因为算法课的作业。其实我一直搞不懂为什么算法课要分成回溯法、分支限界法。不都是搜索 + 剪枝么</p>
<p>好像回溯法是DFS，分支限界法是BFS来着？</p>
<p>这题刚拿到的时候想用DP来做，错了。复盘之后才意识到，dp的顺序必须按BFS序来展开。其实也能做。我是直接按照端点从小到大做的，可能会重复更新。比如我拿着3去更新了2，4，和6，然后遇到4时，可能又会更新3，导致2，6，可能又有了更优的解，但我更新不到</p>
<p>所以，想用DP的话，其实还是要实现BFS，这题直接BFS的算法对一个节点也不会访问第二次，所以没必要</p>
<p>用BFS的经典模型去套的话，本题是一个单向图，每个数字是一个点，即所有可能到达的位置是一个点，起点是N，终点是K，邻居关系是任何一个点cur和cur + 1，cur - 1，以及cur &lt;&lt; 1有单向邻居关系，本题的难点就在这里，将题目要求抽象为一个有向图，只要能想到这一层，接下来的BFS就没什么难度了</p>
<h2 id="解决"><a href="#解决" class="headerlink" title="解决"></a>解决</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">2e5</span> + <span class="number">5</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> v[N];</span><br><span class="line"><span class="keyword">int</span> n, k, ret = <span class="number">0x7fffffff</span>;</span><br><span class="line"><span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; q;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">bfs</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> cur = q.front(); q.pop();</span><br><span class="line">	<span class="keyword">if</span>(cur &gt;= k) ret = min(ret, v[cur] + cur - k - <span class="number">1</span>);</span><br><span class="line">	<span class="keyword">else</span>&#123;</span><br><span class="line">		<span class="keyword">if</span>((cur &lt;&lt; <span class="number">1</span>) &lt; (k &lt;&lt; <span class="number">1</span>) &amp;&amp; v[cur &lt;&lt; <span class="number">1</span>] == <span class="number">0</span>)&#123;</span><br><span class="line">			v[cur &lt;&lt; <span class="number">1</span>] = v[cur] + <span class="number">1</span>;</span><br><span class="line">			q.push(cur &lt;&lt; <span class="number">1</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(v[cur + <span class="number">1</span>] == <span class="number">0</span>)&#123;</span><br><span class="line">			v[cur + <span class="number">1</span>] = v[cur] + <span class="number">1</span>;</span><br><span class="line">			q.push(cur + <span class="number">1</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(cur &amp;&amp; v[cur - <span class="number">1</span>] == <span class="number">0</span>)&#123;</span><br><span class="line">			v[cur - <span class="number">1</span>] = v[cur] + <span class="number">1</span>;</span><br><span class="line">			q.push(cur - <span class="number">1</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">memset</span>(v, <span class="number">0</span>, <span class="keyword">sizeof</span>(v));</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%d %d"</span>, &amp;n, &amp;k);</span><br><span class="line">	v[n] = <span class="number">1</span>;</span><br><span class="line">	q.push(n);</span><br><span class="line">	<span class="keyword">while</span>(!q.empty())&#123;</span><br><span class="line">		bfs();</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%d\n"</span>, ret);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="POJ3322-Bloxorz-I"><a href="#POJ3322-Bloxorz-I" class="headerlink" title="POJ3322_Bloxorz I"></a>POJ3322_Bloxorz I</h1><h2 id="描述-1"><a href="#描述-1" class="headerlink" title="描述"></a>描述</h2><p>一个游戏，控制一个底面为1×1正方形，高为2的长方体在二维网格里翻转行进。长方体可以以它的任意一个面着地，并且永远保持贴近网格的一面的边与网格的边线重合。</p>
<p>所谓翻转行进，就是长方体以它贴近网格的一面的某条棱为轴，沿着把这个面升起来的方向旋转九十度。</p>
<p>网格分为三种，空网格意味着长方体的任何一部分都不能位于它的上面，易碎网格只能支撑长方体一半的重量，这意味着长方体不能以底面朝下的方式立在易碎网格上。普通网格可以支撑长方体的重量，长方体可以以任意一面立在普通网格上。</p>
<p>游戏初始时，长方体会处于某个特定的位置，游戏胜利的方式是将长方体翻转到目标点。</p>
<p>保证目标点是单点，这意味着翻转到目标点时，必然是长方体的一个底面贴在网格上。</p>
<h2 id="思路-1"><a href="#思路-1" class="headerlink" title="思路"></a>思路</h2><p>网格具有天然的邻接关系，可以看做抽象的图，但本题还需要注意的是长方体的状态，即使是在同一个网格，长方体不同的面朝下状态也不一样。理论上长方体有6个面朝下这6种状态，由于对称性可以简化为3种，侧面朝下时，只需要记录靠左和靠下的一格即可</p>
<p>所以实际上，每个网格对应三个抽象的节点，每个抽象的节点是一个二元组——（坐标，状态），然后根据状态转移的规则（即长方体翻转的方式）节点之间有了邻接关系</p>
<p>根据易碎网格，我们可以进行剪枝</p>
<h2 id="解决-1"><a href="#解决-1" class="headerlink" title="解决"></a>解决</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> R = <span class="number">505</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> C = <span class="number">505</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> M[R][C];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> visit[R][C][<span class="number">3</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> r, c, sx, sy, ss;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span>&#123;</span></span><br><span class="line">	<span class="keyword">int</span> x;</span><br><span class="line">	<span class="keyword">int</span> y;</span><br><span class="line">	<span class="keyword">int</span> s;</span><br><span class="line">	<span class="keyword">int</span> step;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">queue</span>&lt;node&gt; q;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">judje</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> s)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(visit[x][y][s]) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">	<span class="keyword">if</span>(s == <span class="number">1</span>)&#123;</span><br><span class="line">		<span class="keyword">if</span>(M[x][y] == <span class="string">'#'</span> || M[x][y] == <span class="string">'E'</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">	&#125;<span class="keyword">else</span> <span class="keyword">if</span>(s == <span class="number">2</span>)&#123;</span><br><span class="line">		<span class="keyword">if</span>(M[x][y] == <span class="string">'#'</span> || M[x][y + <span class="number">1</span>] == <span class="string">'#'</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		<span class="keyword">if</span>(M[x][y] == <span class="string">'#'</span> || M[x + <span class="number">1</span>][y] == <span class="string">'#'</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">bfs</span><span class="params">()</span></span>&#123;</span><br><span class="line">	node cur;</span><br><span class="line">	<span class="keyword">int</span> ret = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span>(!q.empty())&#123;</span><br><span class="line">		cur = q.front();</span><br><span class="line">		q.pop();</span><br><span class="line">		<span class="comment">//printf("%d %d %d %d\n", cur.x, cur.y, cur.s, cur.step);</span></span><br><span class="line">		<span class="keyword">if</span>(cur.s == <span class="number">1</span>)&#123;</span><br><span class="line">			<span class="keyword">if</span>(cur.x &gt; <span class="number">2</span> &amp;&amp; judje(cur.x - <span class="number">2</span>, cur.y, <span class="number">3</span>))&#123;</span><br><span class="line">				visit[cur.x - <span class="number">2</span>][cur.y][<span class="number">3</span>] = <span class="number">1</span>;</span><br><span class="line">				q.push(node&#123;cur.x - <span class="number">2</span>, cur.y, <span class="number">3</span>, cur.step + <span class="number">1</span>&#125;);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span>(cur.x &lt; r - <span class="number">3</span> &amp;&amp; judje(cur.x + <span class="number">1</span>, cur.y, <span class="number">3</span>))&#123;</span><br><span class="line">				visit[cur.x + <span class="number">1</span>][cur.y][<span class="number">3</span>] = <span class="number">1</span>;</span><br><span class="line">				q.push(node&#123;cur.x + <span class="number">1</span>, cur.y, <span class="number">3</span>, cur.step + <span class="number">1</span>&#125;);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span>(cur.y &gt; <span class="number">2</span> &amp;&amp; judje(cur.x, cur.y - <span class="number">2</span>, <span class="number">2</span>))&#123;</span><br><span class="line">				visit[cur.x][cur.y - <span class="number">2</span>][<span class="number">2</span>] = <span class="number">1</span>;</span><br><span class="line">				q.push(node&#123;cur.x, cur.y - <span class="number">2</span>, <span class="number">2</span>, cur.step + <span class="number">1</span>&#125;);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span>(cur.y &lt; c - <span class="number">3</span> &amp;&amp; judje(cur.x, cur.y + <span class="number">1</span>, <span class="number">2</span>))&#123;</span><br><span class="line">				visit[cur.x][cur.y + <span class="number">1</span>][<span class="number">2</span>] = <span class="number">1</span>;</span><br><span class="line">				q.push(node&#123;cur.x, cur.y + <span class="number">1</span>, <span class="number">2</span>, cur.step + <span class="number">1</span>&#125;);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;<span class="keyword">else</span> <span class="keyword">if</span>(cur.s == <span class="number">2</span>)&#123;</span><br><span class="line">			<span class="keyword">if</span>(cur.x &gt; <span class="number">1</span> &amp;&amp; judje(cur.x - <span class="number">1</span>, cur.y, <span class="number">2</span>))&#123;</span><br><span class="line">				visit[cur.x - <span class="number">1</span>][cur.y][<span class="number">2</span>] = <span class="number">1</span>;</span><br><span class="line">				q.push(node&#123;cur.x - <span class="number">1</span>, cur.y, <span class="number">2</span>, cur.step + <span class="number">1</span>&#125;);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span>(cur.x &lt; r - <span class="number">2</span> &amp;&amp; judje(cur.x + <span class="number">1</span>, cur.y, <span class="number">2</span>))&#123;</span><br><span class="line">				visit[cur.x + <span class="number">1</span>][cur.y][<span class="number">2</span>] = <span class="number">1</span>;</span><br><span class="line">				q.push(node&#123;cur.x + <span class="number">1</span>, cur.y, <span class="number">2</span>, cur.step + <span class="number">1</span>&#125;);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span>(cur.y &gt; <span class="number">1</span> &amp;&amp; judje(cur.x, cur.y - <span class="number">1</span>, <span class="number">1</span>))&#123;</span><br><span class="line">				<span class="keyword">if</span>(M[cur.x][cur.y - <span class="number">1</span>] == <span class="string">'O'</span>)&#123;</span><br><span class="line">					ret = cur.step + <span class="number">1</span>;</span><br><span class="line">					<span class="keyword">break</span>;</span><br><span class="line">				&#125;</span><br><span class="line">				visit[cur.x][cur.y - <span class="number">1</span>][<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">				q.push(node&#123;cur.x, cur.y - <span class="number">1</span>, <span class="number">1</span>, cur.step + <span class="number">1</span>&#125;);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span>(cur.y &lt; c - <span class="number">3</span> &amp;&amp; judje(cur.x, cur.y + <span class="number">2</span>, <span class="number">1</span>))&#123;</span><br><span class="line">				<span class="keyword">if</span>(M[cur.x][cur.y + <span class="number">2</span>] == <span class="string">'O'</span>)&#123;</span><br><span class="line">					ret = cur.step + <span class="number">1</span>;</span><br><span class="line">					<span class="keyword">break</span>;</span><br><span class="line">				&#125;</span><br><span class="line">				visit[cur.x][cur.y + <span class="number">2</span>][<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">				q.push(node&#123;cur.x, cur.y + <span class="number">2</span>, <span class="number">1</span>, cur.step + <span class="number">1</span>&#125;);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">			<span class="keyword">if</span>(cur.x &gt; <span class="number">1</span> &amp;&amp; judje(cur.x - <span class="number">1</span>, cur.y, <span class="number">1</span>))&#123;</span><br><span class="line">				<span class="keyword">if</span>(M[cur.x - <span class="number">1</span>][cur.y] == <span class="string">'O'</span>)&#123;</span><br><span class="line">					ret = cur.step + <span class="number">1</span>;</span><br><span class="line">					<span class="keyword">break</span>;</span><br><span class="line">				&#125;</span><br><span class="line">				visit[cur.x - <span class="number">1</span>][cur.y][<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">				q.push(node&#123;cur.x - <span class="number">1</span>, cur.y, <span class="number">1</span>, cur.step + <span class="number">1</span>&#125;);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span>(cur.x &lt; r - <span class="number">3</span> &amp;&amp; judje(cur.x + <span class="number">2</span>, cur.y, <span class="number">1</span>))&#123;</span><br><span class="line">				<span class="keyword">if</span>(M[cur.x + <span class="number">2</span>][cur.y] == <span class="string">'O'</span>)&#123;</span><br><span class="line">					ret = cur.step + <span class="number">1</span>;</span><br><span class="line">					<span class="keyword">break</span>;</span><br><span class="line">				&#125;</span><br><span class="line">				visit[cur.x + <span class="number">2</span>][cur.y][<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">				q.push(node&#123;cur.x + <span class="number">2</span>, cur.y, <span class="number">1</span>, cur.step + <span class="number">1</span>&#125;);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span>(cur.y &gt; <span class="number">1</span> &amp;&amp; judje(cur.x, cur.y - <span class="number">1</span>, <span class="number">3</span>))&#123;</span><br><span class="line">				visit[cur.x][cur.y - <span class="number">1</span>][<span class="number">3</span>] = <span class="number">1</span>;</span><br><span class="line">				q.push(node&#123;cur.x, cur.y - <span class="number">1</span>, <span class="number">3</span>, cur.step + <span class="number">1</span>&#125;);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span>(cur.y &lt; c - <span class="number">2</span> &amp;&amp; judje(cur.x, cur.y + <span class="number">1</span>, <span class="number">3</span>))&#123;</span><br><span class="line">				visit[cur.x][cur.y + <span class="number">1</span>][<span class="number">3</span>] = <span class="number">1</span>;</span><br><span class="line">				q.push(node&#123;cur.x, cur.y + <span class="number">1</span>, <span class="number">3</span>, cur.step + <span class="number">1</span>&#125;);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">"%d %d"</span>, &amp;r, &amp;c) &amp;&amp; r &amp;&amp; c)&#123;</span><br><span class="line">		<span class="built_in">memset</span>(visit, <span class="number">0</span>, <span class="keyword">sizeof</span>(visit));</span><br><span class="line">		<span class="keyword">while</span>(!q.empty()) q.pop();</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; r; ++i)&#123;</span><br><span class="line">			<span class="built_in">scanf</span>(<span class="string">"%s"</span>, M[i]);</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">bool</span> flag = <span class="literal">false</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; r; ++i)&#123;</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; c; ++j)&#123;</span><br><span class="line">				<span class="keyword">if</span>(M[i][j] == <span class="string">'X'</span>)&#123;</span><br><span class="line">					sx = i;</span><br><span class="line">					sy = j;</span><br><span class="line">					<span class="keyword">if</span>(M[i][j + <span class="number">1</span>] == <span class="string">'X'</span>) ss = <span class="number">2</span>;</span><br><span class="line">					<span class="keyword">else</span> <span class="keyword">if</span>(M[i + <span class="number">1</span>][j] == <span class="string">'X'</span>) ss = <span class="number">3</span>;</span><br><span class="line">					<span class="keyword">else</span> ss = <span class="number">1</span>;</span><br><span class="line">					flag = <span class="literal">true</span>;</span><br><span class="line">					<span class="keyword">break</span>;</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">if</span>(flag) <span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		visit[sx][sy][ss] = <span class="number">1</span>;</span><br><span class="line">		q.push(node&#123;sx, sy, ss, <span class="number">0</span>&#125;);</span><br><span class="line">		<span class="keyword">int</span> ret = bfs();</span><br><span class="line">		<span class="keyword">if</span>(ret) <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, ret);</span><br><span class="line">		<span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">"Impossible\n"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="CH2501-矩阵距离"><a href="#CH2501-矩阵距离" class="headerlink" title="CH2501_矩阵距离"></a>CH2501_矩阵距离</h1><h2 id="描述-2"><a href="#描述-2" class="headerlink" title="描述"></a>描述</h2><p>给定一个N行M列的01矩阵 A，A[i][j] 与 A[k][l] 之间的曼哈顿距离定义为：<br>dist(A[i][j],A[k][l])=|i-k|+|j-l|</p>
<p>输出一个N行M列的整数矩阵B，其中：<br>B[i][j]=min(1≤x≤N,1≤y≤M,A[x][y]=1)⁡{dist(A[i][j],A[x][y])}<br>即求与每个位置曼哈顿距离最近的1</p>
<p>N,M≤1000</p>
<h2 id="思路-2"><a href="#思路-2" class="headerlink" title="思路"></a>思路</h2><p>BFS，从每个值为1的点出发，每次向周边蔓延一个单位。这个题就是之前提过的洪泛法</p>
<p>被称为flood-fill，即从源头开始倒水，蔓延到整个图</p>
<h2 id="解决-2"><a href="#解决-2" class="headerlink" title="解决"></a>解决</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1000</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">1000</span> + <span class="number">5</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> a[N][M];</span><br><span class="line"><span class="keyword">int</span> b[N][M];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n, m;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> <span class="built_in">exp</span>[<span class="number">4</span>][<span class="number">2</span>] = &#123;&#123;<span class="number">1</span>, <span class="number">0</span>&#125;, &#123;<span class="number">0</span>, <span class="number">1</span>&#125;, &#123;<span class="number">-1</span>, <span class="number">0</span>&#125;, &#123;<span class="number">0</span>, <span class="number">-1</span>&#125;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; q;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">expand</span><span class="params">(<span class="keyword">int</span> i, <span class="keyword">int</span> j)</span></span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; <span class="number">4</span>; ++k)&#123;</span><br><span class="line">		<span class="keyword">int</span> nx = i + <span class="built_in">exp</span>[k][<span class="number">0</span>];</span><br><span class="line">		<span class="keyword">int</span> ny = j + <span class="built_in">exp</span>[k][<span class="number">1</span>];</span><br><span class="line">		<span class="keyword">if</span>(nx &gt;= <span class="number">0</span> &amp;&amp; ny &gt;= <span class="number">0</span> &amp;&amp; nx &lt; n &amp;&amp; ny &lt; m &amp;&amp; a[nx][ny] == <span class="string">'0'</span> &amp;&amp; b[nx][ny] == <span class="number">0</span>)&#123;</span><br><span class="line">			b[nx][ny] = b[i][j] + <span class="number">1</span>;</span><br><span class="line">			q.push(nx);</span><br><span class="line">			q.push(ny);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">memset</span>(b, <span class="number">0</span>, <span class="keyword">sizeof</span>(b));</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%d %d"</span>, &amp;n, &amp;m);</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i)&#123;</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%s"</span>, a[i]);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i)&#123;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; m; ++j)&#123;</span><br><span class="line">			<span class="keyword">if</span>(a[i][j] == <span class="string">'1'</span>)&#123;</span><br><span class="line">				q.push(i);</span><br><span class="line">				q.push(j);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">while</span>(!q.empty())&#123;</span><br><span class="line">		<span class="keyword">int</span> i = q.front();</span><br><span class="line">		q.pop();</span><br><span class="line">		<span class="keyword">int</span> j = q.front();</span><br><span class="line">		q.pop();</span><br><span class="line">		expand(i, j);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i)&#123;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; m; ++j)&#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">"%d"</span>, b[i][j]);</span><br><span class="line">			<span class="keyword">if</span>(j == m - <span class="number">1</span>) <span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br><span class="line">			<span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">" "</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="POJ1475-Pushing-Boxes"><a href="#POJ1475-Pushing-Boxes" class="headerlink" title="POJ1475_Pushing Boxes"></a>POJ1475_Pushing Boxes</h1><h2 id="描述-3"><a href="#描述-3" class="headerlink" title="描述"></a>描述</h2><p>求解推箱子游戏，要求求出箱子移动次数最少的解，并输出推箱子的路径。如果有多种方式可以让箱子移动最少，输出人物移动最少的那组</p>
<h2 id="数据范围"><a href="#数据范围" class="headerlink" title="数据范围"></a>数据范围</h2><p>地图不大于20 * 20</p>
<h2 id="思路-3"><a href="#思路-3" class="headerlink" title="思路"></a>思路</h2><p>下意识的思路是箱子的位置（二元组）和人的位置（二元组）设置成四元组，但由于过于复杂，会出错</p>
<p>其实这里我没有估计准确——160000个状态节点，每个节点邻接4个状态——再加上碰壁检测可以剪枝，总计感觉是百万级别的计算量，但就是错了</p>
<p>照蓝书上写了一个双重BFS的做法：先外层以箱子的位置为状态进行第一层BFS，每次状态转移时，需要使用第二层BFS来搜索人物移动的最短路径</p>
<p>这题麻烦的一点还在于要输出路径，还需要重新进行搜索，再来一次双重的BFS</p>
<p>所以这个题很难——一般不会想到这种双层BFS的</p>
<h2 id="解决-3"><a href="#解决-3" class="headerlink" title="解决"></a>解决</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">25</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">25</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> r, c;</span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> m[N][M];</span><br><span class="line"><span class="keyword">int</span> visit[N][M][<span class="number">4</span>][<span class="number">5</span>];</span><br><span class="line"><span class="keyword">int</span> hasinqueue[N][M][<span class="number">4</span>];</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">bnode</span>&#123;</span></span><br><span class="line">	<span class="keyword">int</span> x;</span><br><span class="line">	<span class="keyword">int</span> y;</span><br><span class="line">	<span class="keyword">int</span> d;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">pnode</span>&#123;</span></span><br><span class="line">	<span class="keyword">int</span> x;</span><br><span class="line">	<span class="keyword">int</span> y;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> <span class="built_in">exp</span>[<span class="number">4</span>][<span class="number">2</span>] = &#123;&#123;<span class="number">1</span>, <span class="number">0</span>&#125;, &#123;<span class="number">-1</span>, <span class="number">0</span>&#125;, &#123;<span class="number">0</span>, <span class="number">1</span>&#125;, &#123;<span class="number">0</span>, <span class="number">-1</span>&#125;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> rets[] = &#123;<span class="string">'n'</span>, <span class="string">'s'</span>, <span class="string">'w'</span>, <span class="string">'e'</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">stack</span>&lt;<span class="keyword">char</span>&gt; s;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">expand</span><span class="params">(<span class="keyword">int</span> lax, <span class="keyword">int</span> lay, <span class="keyword">int</span> npx, <span class="keyword">int</span> npy, <span class="keyword">int</span> nx, <span class="keyword">int</span> ny)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span>(lax == npx &amp;&amp; lay == npy) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">int</span> v[N][M];</span><br><span class="line">	<span class="built_in">memset</span>(v, <span class="number">0</span>, <span class="keyword">sizeof</span>(v));</span><br><span class="line">	</span><br><span class="line">	<span class="built_in">queue</span>&lt;pnode&gt; q;</span><br><span class="line">	q.push(pnode&#123;lax, lay&#125;);</span><br><span class="line">	v[lax][lay] = <span class="number">1</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//printf("%d %d %d %d %d %d\n", lax, lay, npx, npy, nx, ny);</span></span><br><span class="line">	</span><br><span class="line">	<span class="keyword">while</span>(!q.empty())&#123;</span><br><span class="line">		pnode cur = q.front();</span><br><span class="line">		q.pop();</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//printf("%d %d\n", cur.x, cur.y);</span></span><br><span class="line">		</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; ++i)&#123;</span><br><span class="line">			<span class="keyword">int</span> nnx = cur.x + <span class="built_in">exp</span>[i][<span class="number">0</span>];</span><br><span class="line">			<span class="keyword">int</span> nny = cur.y + <span class="built_in">exp</span>[i][<span class="number">1</span>];</span><br><span class="line">			</span><br><span class="line">			<span class="keyword">if</span>(nnx &lt; <span class="number">0</span> || nny &lt; <span class="number">0</span> || nnx &gt; r - <span class="number">1</span> || nny &gt; c - <span class="number">1</span> || m[nnx][nny] == <span class="string">'#'</span> || v[nnx][nny] || (nx == nnx &amp;&amp; ny == nny)) <span class="keyword">continue</span>;</span><br><span class="line">			</span><br><span class="line">			v[nnx][nny] = v[cur.x][cur.y] + <span class="number">1</span>;</span><br><span class="line">			q.push(pnode&#123;nnx, nny&#125;);</span><br><span class="line">			</span><br><span class="line">			<span class="keyword">if</span>(nnx == npx &amp;&amp; nny == npy)&#123;</span><br><span class="line">				<span class="keyword">return</span> v[nnx][nny] - <span class="number">1</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125; </span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">unexpand</span><span class="params">(<span class="keyword">int</span> lax, <span class="keyword">int</span> lay, <span class="keyword">int</span> npx, <span class="keyword">int</span> npy, <span class="keyword">int</span> nx, <span class="keyword">int</span> ny)</span></span>&#123;</span><br><span class="line">	<span class="comment">//printf("%d %d %d %d %d %d\n", lax, lay, npx, npy, nx, ny);</span></span><br><span class="line">	<span class="keyword">if</span>(lax == npx &amp;&amp; lay == npy) <span class="keyword">return</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">int</span> v[N][M];</span><br><span class="line">	<span class="built_in">memset</span>(v, <span class="number">0</span>, <span class="keyword">sizeof</span>(v));</span><br><span class="line">	</span><br><span class="line">	<span class="built_in">queue</span>&lt;pnode&gt; q;</span><br><span class="line">	q.push(pnode&#123;lax, lay&#125;);</span><br><span class="line">	v[lax][lay] = <span class="number">1</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//printf("%d %d %d %d %d %d\n", lax, lay, npx, npy, nx, ny);</span></span><br><span class="line">	</span><br><span class="line">	<span class="keyword">while</span>(!q.empty())&#123;</span><br><span class="line">		pnode cur = q.front();</span><br><span class="line">		q.pop();</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//printf("%d %d\n", cur.x, cur.y);</span></span><br><span class="line">		</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; ++i)&#123;</span><br><span class="line">			<span class="keyword">int</span> nnx = cur.x + <span class="built_in">exp</span>[i][<span class="number">0</span>];</span><br><span class="line">			<span class="keyword">int</span> nny = cur.y + <span class="built_in">exp</span>[i][<span class="number">1</span>];</span><br><span class="line">			</span><br><span class="line">			<span class="keyword">if</span>(nnx &lt; <span class="number">0</span> || nny &lt; <span class="number">0</span> || nnx &gt; r - <span class="number">1</span> || nny &gt; c - <span class="number">1</span> || m[nnx][nny] == <span class="string">'#'</span> || v[nnx][nny] || (nx == nnx &amp;&amp; ny == nny)) <span class="keyword">continue</span>;</span><br><span class="line">			</span><br><span class="line">			v[nnx][nny] = v[cur.x][cur.y] + <span class="number">1</span>;</span><br><span class="line">			q.push(pnode&#123;nnx, nny&#125;);</span><br><span class="line">			</span><br><span class="line">			<span class="keyword">if</span>(nnx == npx &amp;&amp; nny == npy)&#123;</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/*for(int i = 0 ; i &lt; r; ++i)&#123;</span></span><br><span class="line"><span class="comment">		for(int j = 0; j &lt; c; ++j)&#123;</span></span><br><span class="line"><span class="comment">			printf("%d ", v[i][j]);</span></span><br><span class="line"><span class="comment">		&#125;</span></span><br><span class="line"><span class="comment">		printf("\n");</span></span><br><span class="line"><span class="comment">	&#125;*/</span></span><br><span class="line">	</span><br><span class="line">	<span class="keyword">int</span> px = npx;</span><br><span class="line">	<span class="keyword">int</span> py = npy;</span><br><span class="line">	<span class="keyword">while</span>(px != lax || py != lay)&#123;</span><br><span class="line">		<span class="comment">//printf("%d %d\n", px, py);</span></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; ++i)&#123;</span><br><span class="line">			<span class="keyword">int</span> nnx = px + <span class="built_in">exp</span>[i][<span class="number">0</span>];</span><br><span class="line">			<span class="keyword">int</span> nny = py + <span class="built_in">exp</span>[i][<span class="number">1</span>];</span><br><span class="line">			<span class="keyword">if</span>(nnx &lt; <span class="number">0</span> || nny &lt; <span class="number">0</span> || nnx &gt; r - <span class="number">1</span> || nny &gt; c - <span class="number">1</span> || m[nnx][nny] == <span class="string">'#'</span>) <span class="keyword">continue</span>;</span><br><span class="line">			<span class="keyword">if</span>(v[nnx][nny] == v[px][py] - <span class="number">1</span>)&#123;</span><br><span class="line">				s.push(rets[i]);</span><br><span class="line">				px = nnx;</span><br><span class="line">				py = nny;</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> key = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">"%d %d"</span>, &amp;r, &amp;c) &amp;&amp; r &amp;&amp; c)&#123;</span><br><span class="line">		<span class="built_in">memset</span>(m, <span class="number">0</span>, <span class="keyword">sizeof</span>(m));</span><br><span class="line">		<span class="built_in">memset</span>(visit, <span class="number">0</span>, <span class="keyword">sizeof</span>(visit));</span><br><span class="line">		<span class="built_in">memset</span>(hasinqueue, <span class="number">0</span>, <span class="keyword">sizeof</span>(hasinqueue));</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; r; ++i)&#123;</span><br><span class="line">			<span class="built_in">scanf</span>(<span class="string">"%s"</span>, m[i]);</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="built_in">queue</span>&lt;bnode&gt; q;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">int</span> sx, sy, bx, by, tx, ty;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; r; ++i)&#123;</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; c; ++j)&#123;</span><br><span class="line">				<span class="keyword">if</span>(m[i][j] == <span class="string">'S'</span>)&#123;</span><br><span class="line">					sx = i;</span><br><span class="line">					sy = j;</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">if</span>(m[i][j] == <span class="string">'B'</span>)&#123;</span><br><span class="line">					bx = i;</span><br><span class="line">					by = j;</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">if</span>(m[i][j] == <span class="string">'T'</span>)&#123;</span><br><span class="line">					tx = i;</span><br><span class="line">					ty = j;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; ++i)&#123;</span><br><span class="line">			<span class="keyword">int</span> bpx = bx + <span class="built_in">exp</span>[i][<span class="number">0</span>];</span><br><span class="line">			<span class="keyword">int</span> bpy = by + <span class="built_in">exp</span>[i][<span class="number">1</span>];</span><br><span class="line">			</span><br><span class="line">			<span class="keyword">if</span>(bpx &lt; <span class="number">0</span> || bpy &lt; <span class="number">0</span> || bpx &gt; r - <span class="number">1</span> || bpy &gt; c - <span class="number">1</span> || m[bpx][bpy] == <span class="string">'#'</span>) <span class="keyword">continue</span>;</span><br><span class="line">			</span><br><span class="line">			<span class="keyword">int</span> dps = expand(sx, sy, bpx, bpy, bx, by);</span><br><span class="line">			<span class="keyword">if</span>(dps == <span class="number">-1</span>) <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">			visit[bx][by][i][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">			visit[bx][by][i][<span class="number">1</span>] = dps + <span class="number">1</span>;</span><br><span class="line">			</span><br><span class="line">			q.push(bnode&#123;bx, by, i&#125;);</span><br><span class="line">			hasinqueue[bx][by][i] = <span class="number">1</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">while</span>(!q.empty())&#123;</span><br><span class="line">			bnode cur = q.front();</span><br><span class="line">			q.pop();</span><br><span class="line">			</span><br><span class="line">			<span class="keyword">int</span> nx = cur.x - <span class="built_in">exp</span>[cur.d][<span class="number">0</span>];</span><br><span class="line">			<span class="keyword">int</span> ny = cur.y - <span class="built_in">exp</span>[cur.d][<span class="number">1</span>];</span><br><span class="line">			</span><br><span class="line">			<span class="keyword">if</span>(nx &lt; <span class="number">0</span> || ny &lt; <span class="number">0</span> || nx &gt; r - <span class="number">1</span> || ny &gt; c - <span class="number">1</span> || m[nx][ny] == <span class="string">'#'</span>) <span class="keyword">continue</span>;</span><br><span class="line">			</span><br><span class="line">			<span class="keyword">if</span>(visit[nx][ny][cur.d][<span class="number">0</span>] &amp;&amp; visit[nx][ny][cur.d][<span class="number">0</span>] &lt; visit[cur.x][cur.y][cur.d][<span class="number">0</span>] + <span class="number">1</span>) <span class="keyword">continue</span>;</span><br><span class="line">			</span><br><span class="line">			<span class="keyword">int</span> lax = cur.x;</span><br><span class="line">			<span class="keyword">int</span> lay = cur.y;</span><br><span class="line">			</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; ++i)&#123;</span><br><span class="line">				<span class="keyword">int</span> bpx = nx + <span class="built_in">exp</span>[i][<span class="number">0</span>];</span><br><span class="line">				<span class="keyword">int</span> bpy = ny + <span class="built_in">exp</span>[i][<span class="number">1</span>];</span><br><span class="line">				</span><br><span class="line">				<span class="keyword">if</span>(bpx &lt; <span class="number">0</span> || bpy &lt; <span class="number">0</span> || bpx &gt; r - <span class="number">1</span> || bpy &gt; c - <span class="number">1</span> || m[bpx][bpy] == <span class="string">'#'</span>) <span class="keyword">continue</span>;</span><br><span class="line">				</span><br><span class="line">				<span class="keyword">int</span> dps = expand(lax, lay, bpx, bpy, nx, ny);</span><br><span class="line">				<span class="keyword">if</span>(dps == <span class="number">-1</span>) <span class="keyword">continue</span>;</span><br><span class="line">	</span><br><span class="line">				visit[nx][ny][i][<span class="number">0</span>] = visit[cur.x][cur.y][cur.d][<span class="number">0</span>] + <span class="number">1</span>;</span><br><span class="line">				<span class="keyword">if</span>(visit[nx][ny][i][<span class="number">1</span>] == <span class="number">0</span>)&#123;</span><br><span class="line">					visit[nx][ny][i][<span class="number">1</span>] = visit[cur.x][cur.y][cur.d][<span class="number">1</span>] + dps;</span><br><span class="line">					visit[nx][ny][i][<span class="number">2</span>] = cur.x;</span><br><span class="line">					visit[nx][ny][i][<span class="number">3</span>] = cur.y;</span><br><span class="line">					visit[nx][ny][i][<span class="number">4</span>] = cur.d;</span><br><span class="line">				&#125;<span class="keyword">else</span> <span class="keyword">if</span>(visit[nx][ny][i][<span class="number">1</span>] &gt; visit[cur.x][cur.y][cur.d][<span class="number">1</span>] + dps)&#123;</span><br><span class="line">					visit[nx][ny][i][<span class="number">1</span>] = visit[cur.x][cur.y][cur.d][<span class="number">1</span>] + dps;</span><br><span class="line">					visit[nx][ny][i][<span class="number">2</span>] = cur.x;</span><br><span class="line">					visit[nx][ny][i][<span class="number">3</span>] = cur.y;</span><br><span class="line">					visit[nx][ny][i][<span class="number">4</span>] = cur.d;</span><br><span class="line">				&#125;</span><br><span class="line">				</span><br><span class="line">				<span class="keyword">if</span>(!hasinqueue[nx][ny][i]) q.push(bnode&#123;nx, ny, i&#125;);</span><br><span class="line">				hasinqueue[nx][ny][i] = <span class="number">1</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span>(m[nx][ny] == <span class="string">'T'</span>) <span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">int</span> flag = <span class="number">1</span>;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"Maze #%d\n"</span>, ++key);</span><br><span class="line">		<span class="keyword">int</span> min1 = <span class="number">0x7fffffff</span>;</span><br><span class="line">		<span class="keyword">int</span> pi = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; ++i)&#123;</span><br><span class="line">			<span class="keyword">if</span>(visit[tx][ty][i][<span class="number">0</span>])&#123;</span><br><span class="line">				<span class="keyword">if</span>(visit[tx][ty][i][<span class="number">1</span>] &lt; min1)&#123;</span><br><span class="line">					min1 = visit[tx][ty][i][<span class="number">1</span>];</span><br><span class="line">					pi = i;</span><br><span class="line">				&#125;</span><br><span class="line">				flag = <span class="number">0</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(flag) <span class="built_in">printf</span>(<span class="string">"Impossible."</span>);</span><br><span class="line">		<span class="keyword">else</span>&#123;		</span><br><span class="line">			<span class="comment">//printf("%d %d\n", visit[tx][ty][pi][0]- 1, visit[tx][ty][pi][1] - 1, min1);</span></span><br><span class="line">			<span class="keyword">while</span>(!s.empty()) s.pop();</span><br><span class="line">			<span class="keyword">int</span> px = tx;</span><br><span class="line">			<span class="keyword">int</span> py = ty;</span><br><span class="line">			<span class="keyword">int</span> ps = pi;</span><br><span class="line">			<span class="keyword">while</span>(m[px][py] != <span class="string">'B'</span>)&#123;</span><br><span class="line">				<span class="keyword">int</span> nx = visit[px][py][ps][<span class="number">2</span>];</span><br><span class="line">				<span class="keyword">int</span> ny = visit[px][py][ps][<span class="number">3</span>];</span><br><span class="line">				<span class="keyword">int</span> ns = visit[px][py][ps][<span class="number">4</span>];</span><br><span class="line">				<span class="comment">//printf("%d %d %d\n", nx, ny, ns);</span></span><br><span class="line">				<span class="keyword">if</span>(ns == ps)&#123;</span><br><span class="line">					s.push(rets[ps] - <span class="string">'a'</span> + <span class="string">'A'</span>);</span><br><span class="line">					px = nx;</span><br><span class="line">					py = ny;</span><br><span class="line">				&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">					unexpand(px + <span class="built_in">exp</span>[ns][<span class="number">0</span>], py + <span class="built_in">exp</span>[ns][<span class="number">1</span>], px + <span class="built_in">exp</span>[ps][<span class="number">0</span>], py + <span class="built_in">exp</span>[ps][<span class="number">1</span>], px, py);</span><br><span class="line">					ps = ns;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">				</span><br><span class="line">			unexpand(sx, sy, bx + <span class="built_in">exp</span>[ps][<span class="number">0</span>], by + <span class="built_in">exp</span>[ps][<span class="number">1</span>], bx, by);</span><br><span class="line">				</span><br><span class="line">			<span class="keyword">while</span>(!s.empty())&#123;</span><br><span class="line">				<span class="built_in">printf</span>(<span class="string">"%c"</span>, s.top());</span><br><span class="line">				s.pop();</span><br><span class="line">			&#125;</span><br><span class="line">				</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"\n\n"</span>);</span><br><span class="line">		<span class="comment">/*</span></span><br><span class="line"><span class="comment">		for(int j = 0; j &lt; r; ++j)&#123;</span></span><br><span class="line"><span class="comment">			for(int k = 0; k &lt; c; ++k)&#123;</span></span><br><span class="line"><span class="comment">				for(int i = 0; i &lt; 4; ++i)&#123;</span></span><br><span class="line"><span class="comment">					printf("%3d", visit[j][k][i][0]);</span></span><br><span class="line"><span class="comment">					if(k == c - 1 &amp;&amp; i == 3)printf("\n");</span></span><br><span class="line"><span class="comment">					else if(i == 3) printf("  ");</span></span><br><span class="line"><span class="comment">					else printf(" ");</span></span><br><span class="line"><span class="comment">				&#125;</span></span><br><span class="line"><span class="comment">			&#125;				</span></span><br><span class="line"><span class="comment">		&#125;</span></span><br><span class="line"><span class="comment">		</span></span><br><span class="line"><span class="comment">		printf("\n");</span></span><br><span class="line"><span class="comment">		</span></span><br><span class="line"><span class="comment">		for(int j = 0; j &lt; r; ++j)&#123;</span></span><br><span class="line"><span class="comment">			for(int k = 0; k &lt; c; ++k)&#123;</span></span><br><span class="line"><span class="comment">				for(int i = 0; i &lt; 4; ++i)&#123;</span></span><br><span class="line"><span class="comment">					printf("%3d", visit[j][k][i][1]);</span></span><br><span class="line"><span class="comment">					if(k == c - 1 &amp;&amp; i == 3)printf("\n");</span></span><br><span class="line"><span class="comment">					else if(i == 3) printf("  ");</span></span><br><span class="line"><span class="comment">					else printf(" ");</span></span><br><span class="line"><span class="comment">				&#125;</span></span><br><span class="line"><span class="comment">			&#125;</span></span><br><span class="line"><span class="comment">		&#125;</span></span><br><span class="line"><span class="comment">		*/</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="CH2601-电路维修"><a href="#CH2601-电路维修" class="headerlink" title="CH2601_电路维修"></a>CH2601_电路维修</h1><h2 id="描述-4"><a href="#描述-4" class="headerlink" title="描述"></a>描述</h2><p>Ha’nyu是来自异世界的魔女，她在漫无目的地四处漂流的时候，遇到了善良的少女Rika，从而被收留在地球上。Rika的家里有一辆飞行车。有一天飞行车的电路板突然出现了故障，导致无法启动</p>
<p>电路板的整体结构是一个R行C列的网格（R,C≤500），如下图所示。每个格点都是电线的接点，每个格子都包含一个电子元件。电子元件的主要部分是一个可旋转的、连接一条对角线上的两个接点的短电缆。在旋转之后，它就可以连接另一条对角线的两个接点。电路板左上角的接点接入直流电源，右下角的接点接入飞行车的发动装置</p>
<p><img src="/images/算法题整理——BFS搜索/0.png" alt></p>
<h2 id="思路-4"><a href="#思路-4" class="headerlink" title="思路"></a>思路</h2><p>从某个点到另一个点，如果电路联通，相当于有一条权值为0的路，不连通视为权值为1，在次基础上进行BFS找出最短路。权值为0的路的处理方法是：直接从队头入队</p>
<p>这样就需要一个双端队列</p>
<p>还需要考虑的问题是，我们需要维护某个点到起点的最小距离，因为一个点可能会被访问很多次</p>
<h2 id="解决-4"><a href="#解决-4" class="headerlink" title="解决"></a>解决</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> R = <span class="number">505</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> C = <span class="number">505</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> m[R][C];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> v[R][C];</span><br><span class="line"><span class="keyword">int</span> hasinqueue[R][C];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> <span class="built_in">exp</span>[<span class="number">4</span>][<span class="number">2</span>] = &#123;&#123;<span class="number">1</span>, <span class="number">1</span>&#125;, &#123;<span class="number">1</span>, <span class="number">-1</span>&#125;, &#123;<span class="number">-1</span>, <span class="number">1</span>&#125;, &#123;<span class="number">-1</span>, <span class="number">-1</span>&#125;&#125;;</span><br><span class="line"><span class="keyword">int</span> exp2[<span class="number">4</span>][<span class="number">2</span>] = &#123;&#123;<span class="number">0</span>, <span class="number">0</span>&#125;, &#123;<span class="number">0</span>, <span class="number">-1</span>&#125;, &#123;<span class="number">-1</span>, <span class="number">0</span>&#125;, &#123;<span class="number">-1</span>, <span class="number">-1</span>&#125;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> t, r, c;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;t);</span><br><span class="line">	<span class="keyword">while</span>(t--)&#123;</span><br><span class="line">		<span class="built_in">memset</span>(v, <span class="number">0x7f</span>, <span class="keyword">sizeof</span>(v));</span><br><span class="line">		<span class="built_in">memset</span>(hasinqueue, <span class="number">0</span>, <span class="keyword">sizeof</span>(hasinqueue));</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%d %d"</span>, &amp;r, &amp;c);</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; r; ++i)&#123;</span><br><span class="line">			<span class="built_in">scanf</span>(<span class="string">"%s"</span>, m[i]);</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">if</span>((r + c) % <span class="number">2</span>)&#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">"NO SOLUTION\n"</span>);</span><br><span class="line">			<span class="keyword">continue</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="built_in">deque</span>&lt;<span class="keyword">int</span>&gt; q;</span><br><span class="line">		q.push_back(<span class="number">0</span>);</span><br><span class="line">		q.push_back(<span class="number">0</span>);</span><br><span class="line">		v[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">int</span> x;</span><br><span class="line">		<span class="keyword">int</span> y;</span><br><span class="line">		<span class="keyword">while</span>(!q.empty())&#123;</span><br><span class="line">			x = q.front();</span><br><span class="line">			q.pop_front();</span><br><span class="line">			y = q.front();</span><br><span class="line">			q.pop_front();</span><br><span class="line">			</span><br><span class="line">			<span class="keyword">if</span>(x == r &amp;&amp; y == c) <span class="keyword">break</span>;</span><br><span class="line">			</span><br><span class="line">			<span class="keyword">if</span>(hasinqueue[x][y]) <span class="keyword">continue</span>;</span><br><span class="line">			<span class="keyword">else</span> hasinqueue[x][y] = <span class="number">1</span>;</span><br><span class="line">			<span class="comment">//printf("%d %d %d\n", x, y, v[x][y]);</span></span><br><span class="line">			</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; ++i)&#123;</span><br><span class="line">				<span class="keyword">int</span> nx = x + <span class="built_in">exp</span>[i][<span class="number">0</span>];</span><br><span class="line">				<span class="keyword">int</span> ny = y + <span class="built_in">exp</span>[i][<span class="number">1</span>];</span><br><span class="line">				</span><br><span class="line">				<span class="keyword">if</span>(nx &lt; <span class="number">0</span> || ny &lt; <span class="number">0</span> || nx &gt; r || ny &gt; c) <span class="keyword">continue</span>;</span><br><span class="line">				</span><br><span class="line">				<span class="keyword">if</span>(m[x + exp2[i][<span class="number">0</span>]][y + exp2[i][<span class="number">1</span>]] == <span class="string">'/'</span>)&#123;</span><br><span class="line">					<span class="keyword">if</span>(i == <span class="number">0</span> || i == <span class="number">3</span>)&#123;</span><br><span class="line">						<span class="keyword">if</span>(v[nx][ny] &gt; v[x][y] + <span class="number">1</span>)&#123;</span><br><span class="line">							v[nx][ny] = v[x][y] + <span class="number">1</span>;</span><br><span class="line">							q.push_back(nx);</span><br><span class="line">							q.push_back(ny);</span><br><span class="line">						&#125;</span><br><span class="line">					&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">						<span class="keyword">if</span>(v[nx][ny] &gt; v[x][y])&#123;</span><br><span class="line">							v[nx][ny] = v[x][y];</span><br><span class="line">							q.push_front(ny);</span><br><span class="line">							q.push_front(nx);</span><br><span class="line">						&#125;</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">					<span class="keyword">if</span>(i == <span class="number">2</span> || i == <span class="number">1</span>)&#123;</span><br><span class="line">						<span class="keyword">if</span>(v[nx][ny] &gt; v[x][y] + <span class="number">1</span>)&#123;</span><br><span class="line">							v[nx][ny] = v[x][y] + <span class="number">1</span>;</span><br><span class="line">							q.push_back(nx);</span><br><span class="line">							q.push_back(ny);</span><br><span class="line">						&#125;</span><br><span class="line">					&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">						<span class="keyword">if</span>(v[nx][ny] &gt; v[x][y])&#123;</span><br><span class="line">							v[nx][ny] = v[x][y];</span><br><span class="line">							q.push_front(ny);</span><br><span class="line">							q.push_front(nx);</span><br><span class="line">						&#125;</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"%d\n"</span>, v[r][c]);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="POJ3635-Full-Tank"><a href="#POJ3635-Full-Tank" class="headerlink" title="POJ3635_Full Tank?"></a>POJ3635_Full Tank?</h1><h2 id="描述-5"><a href="#描述-5" class="headerlink" title="描述"></a>描述</h2><p>有n个城市之间通过m条路相连，每条路都有一个权值，表示汽车从该路的一端到达另一端需要消耗的汽油数。每个城市都有加油站，并且不同的加油站可能油价不相同</p>
<p>现在，给出一些询问，要求计算出最小的花销</p>
<p>每条询问包含油箱的容量c，起始城市s，终点城市e</p>
<p>如果无解输出impossible</p>
<h2 id="数据范围-1"><a href="#数据范围-1" class="headerlink" title="数据范围"></a>数据范围</h2><p>c不大于100，城市数目不大于1000，道路数目不大于10000，每个城市的油价不大于100</p>
<h2 id="思路-5"><a href="#思路-5" class="headerlink" title="思路"></a>思路</h2><p>BFS其实只是这题的基础，单纯的BFS其实是解决不了这种带权值的问题的，将二元组(city, oil)作为状态，使用优先队列来取出当前所有可达状态中花费最小的。然后，对于每个状态，可以有两种选择：一是在油箱没满的情况下，可以就地加油；二是在油箱里的油足够的情况下，去相邻的城市</p>
<p>直到终点城市第一次从队列中取出，BFS结束</p>
<p>无解的判断可以在求解开始之前，先进行一个BFS连通性判断</p>
<p>仅有上面的框架还不够，本题需要进行优化：记录某个状态下的最小花费，如果取出某个状态时发现其花费大于之前某个状态的最小花费，则舍弃，否则更新并继续遍历</p>
<h2 id="解决-5"><a href="#解决-5" class="headerlink" title="解决"></a>解决</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1005</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">10005</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> p[N];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> a[N][N];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> lista[N][N];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n, m, u, v, d, q, c, s, e;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> visit[N];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> ans[N][<span class="number">105</span>];</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">node</span>&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="keyword">int</span> cost;</span><br><span class="line">	<span class="keyword">int</span> city;</span><br><span class="line">	<span class="keyword">int</span> oil;</span><br><span class="line">	<span class="keyword">const</span> <span class="keyword">bool</span> <span class="keyword">operator</span> &gt; (<span class="keyword">const</span> node &amp;n) <span class="keyword">const</span>;</span><br><span class="line">	<span class="keyword">const</span> <span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> node &amp;n) <span class="keyword">const</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">bool</span> node::<span class="keyword">operator</span> &gt; (<span class="keyword">const</span> node &amp;n) <span class="keyword">const</span>&#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="keyword">this</span>-&gt;cost &lt; n.cost;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">bool</span> node::<span class="keyword">operator</span> &lt; (<span class="keyword">const</span> node &amp;n) <span class="keyword">const</span>&#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="keyword">this</span>-&gt;cost &gt; n.cost;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">judje</span><span class="params">(<span class="keyword">int</span> c)</span></span>&#123;</span><br><span class="line">	<span class="built_in">memset</span>(visit, <span class="number">0</span>, <span class="keyword">sizeof</span>(visit));</span><br><span class="line">	visit[s] = <span class="number">1</span>;</span><br><span class="line">	<span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; qu;</span><br><span class="line">	qu.push(s);</span><br><span class="line">	<span class="keyword">while</span>(!qu.empty())&#123;</span><br><span class="line">		<span class="keyword">int</span> cur = qu.front();</span><br><span class="line">		<span class="comment">//printf("%d\n", cur);</span></span><br><span class="line">		qu.pop();</span><br><span class="line">		<span class="keyword">if</span>(cur == e) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; lista[cur][i] != <span class="number">-1</span>; ++i)&#123;</span><br><span class="line">			<span class="keyword">if</span>(!visit[lista[cur][i]] &amp;&amp; a[cur][lista[cur][i]] &lt;= c)&#123;</span><br><span class="line">				qu.push(lista[cur][i]);</span><br><span class="line">				visit[lista[cur][i]] = <span class="number">1</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">memset</span>(a, <span class="number">0</span>, <span class="keyword">sizeof</span>(a));</span><br><span class="line">	<span class="built_in">memset</span>(lista, <span class="number">-1</span>, <span class="keyword">sizeof</span>(lista));</span><br><span class="line">	</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%d %d"</span>, &amp;n, &amp;m);</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i)&#123;</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;p[i]);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; ++i)&#123;</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%d %d %d"</span>, &amp;u, &amp;v, &amp;d);</span><br><span class="line">		a[u][v] = a[v][u] = d;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i)&#123;</span><br><span class="line">		<span class="keyword">int</span> con = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; n; ++j)&#123;</span><br><span class="line">			<span class="keyword">if</span>(a[i][j])&#123;</span><br><span class="line">				lista[i][con++] = j;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;q);</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">while</span>(q--)&#123;</span><br><span class="line">		<span class="built_in">memset</span>(ans, <span class="number">0x7f</span>, <span class="keyword">sizeof</span>(ans));</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%d %d %d"</span>, &amp;c, &amp;s, &amp;e);</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">if</span>(judje(c))&#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">"impossible\n"</span>);</span><br><span class="line">			<span class="keyword">continue</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		priority_queue&lt;node&gt; qu;</span><br><span class="line">		qu.push(node&#123;<span class="number">0</span>, s, <span class="number">0</span>&#125;);</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">while</span>(!qu.empty())&#123;</span><br><span class="line">			node cur = qu.top();</span><br><span class="line">			<span class="comment">//printf("%d %d %d\n", cur.cost, cur.city, cur.oil);</span></span><br><span class="line">			qu.pop();</span><br><span class="line">			</span><br><span class="line">			<span class="keyword">if</span>(ans[cur.city][cur.oil] &gt; cur.cost)&#123;</span><br><span class="line">				ans[cur.city][cur.oil] = cur.cost;</span><br><span class="line">			&#125;<span class="keyword">else</span> <span class="keyword">continue</span>;</span><br><span class="line">			</span><br><span class="line">			<span class="keyword">if</span>(cur.city == e)&#123;</span><br><span class="line">				<span class="built_in">printf</span>(<span class="string">"%d\n"</span>, cur.cost);</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; lista[cur.city][i] != <span class="number">-1</span>; ++i)&#123;</span><br><span class="line">				<span class="comment">//printf("city: %d oli: %d target: %d cost: %d\n", cur.city, cur.oil, lista[cur.city][i], a[cur.city][lista[cur.city][i]]);</span></span><br><span class="line">				<span class="keyword">if</span>(cur.oil &gt;= a[cur.city][lista[cur.city][i]])&#123;</span><br><span class="line">					qu.push(node&#123;cur.cost, lista[cur.city][i], cur.oil - a[cur.city][lista[cur.city][i]]&#125;);</span><br><span class="line">					<span class="comment">//printf("city %d is arrived\n", lista[cur.city][i]);</span></span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span>(cur.oil &lt; c)&#123;</span><br><span class="line">				qu.push(node&#123;cur.cost + p[cur.city], cur.city, cur.oil + <span class="number">1</span>&#125;);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="HDOJ3085-Nightmare-II"><a href="#HDOJ3085-Nightmare-II" class="headerlink" title="HDOJ3085_Nightmare II"></a>HDOJ3085_Nightmare II</h1><h2 id="描述-6"><a href="#描述-6" class="headerlink" title="描述"></a>描述</h2><p>从前有一个抽象怪叫erriyue，他做了一个噩梦，梦里他和女友被困在迷宫的不同位置，有两个鬼在抓他们，他们要赶在被鬼抓住之前汇合</p>
<p>erriyue每秒可以移动3个曼哈顿距离，女友只能移动一个（气抖冷），鬼会向所有距离鬼现在位置曼哈顿距离小于等于2的地方分裂，无视墙壁，直到整个迷宫的每个格都有一个鬼</p>
<p>每一秒，鬼会先行动</p>
<h2 id="思路-6"><a href="#思路-6" class="headerlink" title="思路"></a>思路</h2><p>双向BFS，以秒为单位，找出每秒erriyue和女友可以到达的位置，直到erriyue或者女友发现自己可以到达一个对方到过的位置为止</p>
<p>注意判断BFS新拓展出的节点是否可达时，应考虑越界，离鬼太近，撞墙和已经来过这些情况</p>
<p>由于我一开始没看到鬼会先行动，所以绕了弯子，可达的新节点在下一秒仍有可能被鬼抓到，所以在取出新节点时又加入了一个是否会被抓到的判断</p>
<p>最后交上去只过了66.7%的测试点，仔细检查发现是一不小心输出了调试信息……</p>
<h2 id="解决-6"><a href="#解决-6" class="headerlink" title="解决"></a>解决</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">800</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">800</span> + <span class="number">5</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> Maze[N][M];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> visit[N][M];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> t, n, m, TIME;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">point</span>&#123;</span></span><br><span class="line">	<span class="keyword">int</span> x;</span><br><span class="line">	<span class="keyword">int</span> y;</span><br><span class="line">&#125;; </span><br><span class="line"></span><br><span class="line">point g1, g2, boy, girl, direction[<span class="number">4</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printpoint</span><span class="params">(point p)</span></span>&#123;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"x: %d y: %d\n"</span>, p.x, p.y);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line">	direction[<span class="number">0</span>].x = <span class="number">1</span>;</span><br><span class="line">	direction[<span class="number">0</span>].y = <span class="number">0</span>;</span><br><span class="line">	direction[<span class="number">1</span>].x = <span class="number">-1</span>;</span><br><span class="line">	direction[<span class="number">1</span>].y = <span class="number">0</span>;</span><br><span class="line">	direction[<span class="number">2</span>].x = <span class="number">0</span>;</span><br><span class="line">	direction[<span class="number">2</span>].y = <span class="number">1</span>;</span><br><span class="line">	direction[<span class="number">3</span>].x = <span class="number">0</span>;</span><br><span class="line">	direction[<span class="number">3</span>].y = <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">canarrive</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(x &lt; <span class="number">0</span> || y &lt; <span class="number">0</span> || x &gt;= n || y &gt;= m) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">	<span class="keyword">if</span>(Maze[x][y] == <span class="string">'X'</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">	<span class="keyword">if</span>(<span class="built_in">abs</span>(x - g1.x) + <span class="built_in">abs</span>(y - g1.y) &lt;= TIME * <span class="number">2</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">	<span class="keyword">if</span>(<span class="built_in">abs</span>(x - g2.x) + <span class="built_in">abs</span>(y - g2.y) &lt;= TIME * <span class="number">2</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">hasbeenfill</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(<span class="built_in">abs</span>(x - g1.x) + <span class="built_in">abs</span>(y - g1.y) &lt;= TIME * <span class="number">2</span>) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">	<span class="keyword">if</span>(<span class="built_in">abs</span>(x - g2.x) + <span class="built_in">abs</span>(y - g2.y) &lt;= TIME * <span class="number">2</span>) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="comment">//freopen("INPUT.txt", "r", stdin);</span></span><br><span class="line">	init();</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;t);</span><br><span class="line">	<span class="keyword">while</span>(t--)&#123;</span><br><span class="line">		<span class="built_in">memset</span>(visit, <span class="number">0</span>, <span class="keyword">sizeof</span>(visit));</span><br><span class="line">		</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%d %d"</span>, &amp;n, &amp;m);</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i)&#123;</span><br><span class="line">			<span class="built_in">scanf</span>(<span class="string">"%s"</span>, Maze[i]);</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">int</span> con = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i)&#123;</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; m; ++j)&#123;</span><br><span class="line">				<span class="keyword">switch</span> (Maze[i][j])&#123;</span><br><span class="line">					<span class="keyword">case</span> <span class="string">'M'</span>:</span><br><span class="line">						boy.x = i;</span><br><span class="line">						boy.y = j;</span><br><span class="line">						<span class="keyword">break</span>;</span><br><span class="line">					<span class="keyword">case</span> <span class="string">'G'</span>:</span><br><span class="line">						girl.x = i;</span><br><span class="line">						girl.y = j;</span><br><span class="line">						<span class="keyword">break</span>;</span><br><span class="line">					<span class="keyword">case</span> <span class="string">'Z'</span>:</span><br><span class="line">						<span class="keyword">if</span>(con == <span class="number">0</span>)&#123;</span><br><span class="line">							g1.x = i;</span><br><span class="line">							g1.y = j;</span><br><span class="line">							++con;</span><br><span class="line">						&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">							g2.x = i;</span><br><span class="line">							g2.y = j;</span><br><span class="line">							++con;</span><br><span class="line">						&#125;</span><br><span class="line">						<span class="keyword">break</span>;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		TIME = <span class="number">0</span>;</span><br><span class="line">		</span><br><span class="line">		<span class="built_in">queue</span>&lt;point&gt; qboy[<span class="number">2</span>];</span><br><span class="line">		<span class="built_in">queue</span>&lt;point&gt; qgirl[<span class="number">2</span>];</span><br><span class="line">		</span><br><span class="line">		qboy[<span class="number">1</span>].push(boy);</span><br><span class="line">		qgirl[<span class="number">1</span>].push(girl);</span><br><span class="line">		</span><br><span class="line">		visit[boy.x][boy.y] = <span class="number">1</span>;</span><br><span class="line">		visit[girl.x][girl.y] = <span class="number">2</span>;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">int</span> flag = <span class="number">0</span>;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">while</span>(!(qboy[<span class="number">0</span>].empty() &amp;&amp; qboy[<span class="number">1</span>].empty() &amp;&amp; qgirl[<span class="number">0</span>].empty() &amp;&amp; qgirl[<span class="number">1</span>].empty()))&#123;</span><br><span class="line">			++TIME;</span><br><span class="line">			<span class="keyword">int</span> now = TIME % <span class="number">2</span>;</span><br><span class="line">			<span class="keyword">int</span> next = <span class="number">1</span> - now;</span><br><span class="line">			</span><br><span class="line">			<span class="comment">//printf("boy1\n");</span></span><br><span class="line">			<span class="keyword">while</span>(!qboy[now].empty())&#123;</span><br><span class="line">				point curboy = qboy[now].front();</span><br><span class="line">				qboy[now].pop();</span><br><span class="line">				</span><br><span class="line">				<span class="keyword">if</span>(hasbeenfill(curboy.x, curboy.y)) <span class="keyword">continue</span>;</span><br><span class="line">				</span><br><span class="line">				<span class="comment">//printpoint(curboy);</span></span><br><span class="line">				</span><br><span class="line">				<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; ++i)&#123;</span><br><span class="line">					<span class="keyword">int</span> newx = curboy.x + direction[i].x;</span><br><span class="line">					<span class="keyword">int</span> newy = curboy.y + direction[i].y;</span><br><span class="line">					<span class="keyword">if</span>(canarrive(newx, newy))&#123;</span><br><span class="line">						<span class="keyword">if</span>(!visit[newx][newy])&#123;</span><br><span class="line">							visit[newx][newy] = <span class="number">1</span>;</span><br><span class="line">							qboy[next].push(point&#123;newx, newy&#125;);</span><br><span class="line">						&#125;<span class="keyword">else</span> <span class="keyword">if</span>(visit[newx][newy] == <span class="number">1</span>) <span class="keyword">continue</span>;</span><br><span class="line">						<span class="keyword">else</span>&#123;</span><br><span class="line">							flag = <span class="number">1</span>;</span><br><span class="line">							<span class="keyword">break</span>;</span><br><span class="line">						&#125;</span><br><span class="line">					&#125;	</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">			<span class="keyword">if</span>(flag) <span class="keyword">break</span>;</span><br><span class="line">			</span><br><span class="line">			<span class="comment">//printf("boy2\n");</span></span><br><span class="line">			<span class="keyword">while</span>(!qboy[next].empty())&#123;</span><br><span class="line">				point curboy = qboy[next].front();</span><br><span class="line">				qboy[next].pop();</span><br><span class="line">				</span><br><span class="line">				<span class="comment">//printpoint(curboy);</span></span><br><span class="line">				</span><br><span class="line">				<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; ++i)&#123;</span><br><span class="line">					<span class="keyword">int</span> newx = curboy.x + direction[i].x;</span><br><span class="line">					<span class="keyword">int</span> newy = curboy.y + direction[i].y;</span><br><span class="line">					<span class="keyword">if</span>(canarrive(newx, newy))&#123;</span><br><span class="line">						<span class="keyword">if</span>(!visit[newx][newy])&#123;</span><br><span class="line">							visit[newx][newy] = <span class="number">1</span>;</span><br><span class="line">							qboy[now].push(point&#123;newx, newy&#125;);</span><br><span class="line">						&#125;<span class="keyword">else</span> <span class="keyword">if</span>(visit[newx][newy] == <span class="number">1</span>) <span class="keyword">continue</span>;</span><br><span class="line">						<span class="keyword">else</span>&#123;</span><br><span class="line">							<span class="comment">//printf("newx %d newy %d visit %d\n", newx, newy, visit[newx][newy]);</span></span><br><span class="line">							flag = <span class="number">1</span>;</span><br><span class="line">							<span class="keyword">break</span>;</span><br><span class="line">						&#125;</span><br><span class="line">					&#125;	</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">			<span class="keyword">if</span>(flag) <span class="keyword">break</span>;</span><br><span class="line">			</span><br><span class="line">			<span class="comment">//printf("boy3\n");</span></span><br><span class="line">			<span class="keyword">while</span>(!qboy[now].empty())&#123;</span><br><span class="line">				point curboy = qboy[now].front();</span><br><span class="line">				qboy[now].pop();</span><br><span class="line">				</span><br><span class="line">				<span class="comment">//printpoint(curboy);</span></span><br><span class="line">				</span><br><span class="line">				<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; ++i)&#123;</span><br><span class="line">					<span class="keyword">int</span> newx = curboy.x + direction[i].x;</span><br><span class="line">					<span class="keyword">int</span> newy = curboy.y + direction[i].y;</span><br><span class="line">					<span class="keyword">if</span>(canarrive(newx, newy))&#123;</span><br><span class="line">						<span class="keyword">if</span>(!visit[newx][newy])&#123;</span><br><span class="line">							visit[newx][newy] = <span class="number">1</span>;</span><br><span class="line">							qboy[next].push(point&#123;newx, newy&#125;);</span><br><span class="line">						&#125;<span class="keyword">else</span> <span class="keyword">if</span>(visit[newx][newy] == <span class="number">1</span>) <span class="keyword">continue</span>;</span><br><span class="line">						<span class="keyword">else</span>&#123;</span><br><span class="line">							flag = <span class="number">1</span>;</span><br><span class="line">							<span class="keyword">break</span>;</span><br><span class="line">						&#125;</span><br><span class="line">					&#125;	</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">			<span class="keyword">if</span>(flag) <span class="keyword">break</span>;</span><br><span class="line">			</span><br><span class="line">			<span class="comment">//printf("girl\n");</span></span><br><span class="line">			<span class="keyword">while</span>(!qgirl[now].empty())&#123;</span><br><span class="line">				point curgirl = qgirl[now].front();</span><br><span class="line">				qgirl[now].pop();</span><br><span class="line">				</span><br><span class="line">				<span class="keyword">if</span>(hasbeenfill(curgirl.x, curgirl.y)) <span class="keyword">continue</span>;</span><br><span class="line">				</span><br><span class="line">				<span class="comment">//printpoint(curgirl);</span></span><br><span class="line">				</span><br><span class="line">				<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; ++i)&#123;</span><br><span class="line">					<span class="keyword">int</span> newx = curgirl.x + direction[i].x;</span><br><span class="line">					<span class="keyword">int</span> newy = curgirl.y + direction[i].y;</span><br><span class="line">					<span class="keyword">if</span>(canarrive(newx, newy))&#123;</span><br><span class="line">						<span class="keyword">if</span>(!visit[newx][newy])&#123;</span><br><span class="line">							visit[newx][newy] = <span class="number">2</span>;</span><br><span class="line">							qgirl[next].push(point&#123;newx, newy&#125;);</span><br><span class="line">						&#125;<span class="keyword">else</span> <span class="keyword">if</span>(visit[newx][newy] == <span class="number">1</span>)&#123;</span><br><span class="line">							flag = <span class="number">1</span>;</span><br><span class="line">							<span class="keyword">break</span>;</span><br><span class="line">						&#125;<span class="keyword">else</span> <span class="keyword">continue</span>;</span><br><span class="line">					&#125;	</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">			<span class="keyword">if</span>(flag) <span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">if</span>(flag) <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, TIME);</span><br><span class="line">		<span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">"-1\n"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/基础算法/" rel="tag"># 基础算法</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2022/12/24/软件工程-1/" rel="next" title="软件工程">
                <i class="fa fa-chevron-left"></i> 软件工程
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2023/01/15/矩阵论课程笔记/" rel="prev" title="矩阵论课程笔记">
                矩阵论课程笔记 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">Jameci</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">138</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">12</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">42</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#POJ3278-Catch-The-Cow"><span class="nav-number">1.</span> <span class="nav-text">POJ3278_Catch The Cow</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#描述"><span class="nav-number">1.1.</span> <span class="nav-text">描述</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#思路"><span class="nav-number">1.2.</span> <span class="nav-text">思路</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#解决"><span class="nav-number">1.3.</span> <span class="nav-text">解决</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#POJ3322-Bloxorz-I"><span class="nav-number">2.</span> <span class="nav-text">POJ3322_Bloxorz I</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#描述-1"><span class="nav-number">2.1.</span> <span class="nav-text">描述</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#思路-1"><span class="nav-number">2.2.</span> <span class="nav-text">思路</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#解决-1"><span class="nav-number">2.3.</span> <span class="nav-text">解决</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#CH2501-矩阵距离"><span class="nav-number">3.</span> <span class="nav-text">CH2501_矩阵距离</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#描述-2"><span class="nav-number">3.1.</span> <span class="nav-text">描述</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#思路-2"><span class="nav-number">3.2.</span> <span class="nav-text">思路</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#解决-2"><span class="nav-number">3.3.</span> <span class="nav-text">解决</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#POJ1475-Pushing-Boxes"><span class="nav-number">4.</span> <span class="nav-text">POJ1475_Pushing Boxes</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#描述-3"><span class="nav-number">4.1.</span> <span class="nav-text">描述</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#数据范围"><span class="nav-number">4.2.</span> <span class="nav-text">数据范围</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#思路-3"><span class="nav-number">4.3.</span> <span class="nav-text">思路</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#解决-3"><span class="nav-number">4.4.</span> <span class="nav-text">解决</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#CH2601-电路维修"><span class="nav-number">5.</span> <span class="nav-text">CH2601_电路维修</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#描述-4"><span class="nav-number">5.1.</span> <span class="nav-text">描述</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#思路-4"><span class="nav-number">5.2.</span> <span class="nav-text">思路</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#解决-4"><span class="nav-number">5.3.</span> <span class="nav-text">解决</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#POJ3635-Full-Tank"><span class="nav-number">6.</span> <span class="nav-text">POJ3635_Full Tank?</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#描述-5"><span class="nav-number">6.1.</span> <span class="nav-text">描述</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#数据范围-1"><span class="nav-number">6.2.</span> <span class="nav-text">数据范围</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#思路-5"><span class="nav-number">6.3.</span> <span class="nav-text">思路</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#解决-5"><span class="nav-number">6.4.</span> <span class="nav-text">解决</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#HDOJ3085-Nightmare-II"><span class="nav-number">7.</span> <span class="nav-text">HDOJ3085_Nightmare II</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#描述-6"><span class="nav-number">7.1.</span> <span class="nav-text">描述</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#思路-6"><span class="nav-number">7.2.</span> <span class="nav-text">思路</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#解决-6"><span class="nav-number">7.3.</span> <span class="nav-text">解决</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Jameci</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




        
<div class="busuanzi-count">
  <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv">
      <i class="fa fa-user"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
      
    </span>
  

  
    <span class="site-pv">
      <i class="fa fa-eye"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
      
    </span>
  
</div>








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
